<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Drawing Bina</title>  
    <link rel="icon" type="image/png" href="img/icon.png" sizes="32x32">
    <!-- Bootstrap CSS -->  
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">  
    <link rel="stylesheet" href="css/index.css">

<style>
    body {
            min-height: 130vh;
            height: 110%;
            margin: 0;
            background: linear-gradient(to bottom, #fff, #dbeafe 75%);
        }
        .city-silhouette {
            position: fixed;   /* absolute değil, fixed! */
            left: 0; right: 0; bottom: 0;
            width: 100vw;
            height: 24vh;
            min-height: 100px;
            max-height: 220px;
            pointer-events: none;
            opacity: 0.5;
        }
        .main-content {
            position: relative;
            z-index: 2;
        }
        .frost {
            backdrop-filter: blur(8px) brightness(0.96);
        }


      .container-navbar {  
        display: flex;  
        flex: 0 0 100%;  
        flex-wrap: nowrap;  
        align-items: center;  
        justify-content: center;  
        margin: 0px;
      }  
      .container-fluid {  
        display: flex;  
        flex: 0 0 100%;  
        flex-wrap: nowrap;  
        align-items: center;  
      }  
      #projectName {  
        flex: 0 0 90%;  
        white-space: nowrap;  
        overflow: hidden;  
        text-overflow: ellipsis;  
        font-family: Arial, sans-serif;  
        font-size: 36px;
      }  
      .img-fluid {  
        flex: 0 0 auto;  
        height: 30px;  
        width: 30px;  
        margin-right: 10px;  
      }
      .custom-btn {  
        background-color: #847539;
        color: white; /* Yazı rengi */  
        border: none; /* Kenarlığın kaldırılması */  
        border-radius: 10px; /* Kenarlıkları yuvarlaklaştırma */  
        padding: 10px 20px; /* İç boşluklar */  
        font-family: "Varela Round";  
        font-size: 16px; /* Yazı boyutu */  
        font-weight: bold; /* Kalın yazı */  
        letter-spacing: 2px;
        cursor: pointer; /* Fare imlecini işaretçi yapma */  
        transition: background-color 0.3s ease; /* Hover geçiş efekti */
        margin-right: 40px;
      }
      .payment-container {
        max-width:430px; margin:44px auto; background:#fff;
        border-radius:16px; box-shadow:0 2px 14px 1px #0002; padding:32px 28px 28px 28px;
      }
      .bank-info, .credit-card-fields { display:none; }
      .selectable { user-select:all; }
      .modal-lg { max-width: 790px; }
      /* Yasal metin linkleri ve erişilebilirlik */
      .form-check-label a {
        text-decoration: underline;
        color: #0d6efd !important;
        transition: color .18s, background .19s;
        font-weight: 500;
        padding: 1px 3px;
        border-radius: 3px;
        cursor: pointer;
      }
      .form-check-label a:hover, .form-check-label a:focus {
        color: #fff !important;
        background: #0d6efd;
        text-decoration: underline !important;
        outline: none;
      }
      .form-check-label { cursor:pointer; }

      @media (max-width: 768px) {
          body {
                min-height: 100vh;
                height: 100%;
            }
            .city-silhouette {
                position: fixed;
                left: 0; right: 0; bottom: 0;
                width: 100vw;
                height: 14vh;
                min-height: 70px;
                max-height: 150px;
            }

          .container-navbar {  
            flex-wrap: wrap;  
            justify-content: flex-end;  
          }  
          #projectName {
            flex: 0 0 70%;  
            overflow: hidden;  
            text-overflow: ellipsis;  
            white-space: nowrap;  
            text-align: left;  
            font-size: 14px !important;  
            max-width: 65%;     /* Taşmayı önler */  
            min-width: 0;       /* flex shrink için gerekli */  
            margin-right: 0;    /* İstenirse gap için elle ekleyin */
          }  
          #buttonHome {
            flex: 0 0 30px;     /* Eğer 30px'lik bir kutu ise tam sabitlenir */  
            padding: 0;         /* Ekstra boşlukları engeller */  
            margin-left: 0;     /* İstenirse 5px gibi küçük bir boşluk eklenebilir */  
            display: flex;  
            align-items: center;
          }
          .img-fluid {  
            height: 25px;  
            width: 25px;  
            margin-right: 0;    /* Sağdan boşluğu kaldırır */  
            margin-left: 0;     /* Soldan boşluğu kaldırır */
          }  
          .custom-btn {  
            font-size: 12px; /* Yazı boyutu */
            padding: 5px 10px;      /* Yan boşlukları biraz artırdım */
            border-radius: 6px;      /* Köşeler hafif yuvarlatıldı */
            color: #fff;
            border: none;
            margin-right: 12px;
            display: inline-block; 
            font-weight: 500;     
          }
          .navbar-toggler {  
            /* background-color: rgb(89, 125, 234);  */
            background-color: #c2c5c9;
            flex: 0 0 auto;  
            margin-left: auto;  
            justify-content: flex-end;  
          }
          .container-fluid {  
            flex-wrap: wrap;  
          } 
          .dropdown-item{
            display: flex;
            margin-left: auto;  
            justify-content: flex-end;
          }
          .mobile-navbar-menu {  
            justify-content: flex-end !important;  
            text-align: right !important;  
            margin-top: 10px;
            margin-bottom: 5px;
          }  
          .mobile-navbar-menu .nav-item, .mobile-navbar-menu .dropdown-item-mobile {
            display: flex;
            align-items: center;
            justify-content: space-between !important;  
            text-align: right !important;
            font-size: 1.1rem;
            font-style: bold !important;
            height: 22px;
            margin-top: 2px;
            justify-self: end;
          }
          .dropdown-item-mobile {
            width: 34%;
            font-family: Arial, sans-serif !important; 
            color: rgb(94, 93, 93) !important;      /* Varsayılan metin rengini kullan */  
            text-decoration: none !important; /* Altı çizgiyi kaldır */  
            font-weight: 400 !important;
          }


          .payment-container {
            max-width: 85vw;
            /*margin: 20px 0 0 0;        üstten biraz boşluk bırak, yandan sıfır */
            border-radius: 0;          /* köşe yumuşaklığı kalkabilir mobilde */
            box-shadow: none;          /* ister kaldır, ister azalt */
            padding: 18px 7vw 20px 7vw; /* sağ-sol padding sayfa kenarından biraz içeride */
          }
          .bank-info, .credit-card-fields {
            padding: 12px 6px;          /* kutu içeriği mobilde daha dar */
            font-size: 0.98em;
          }
          .modal-lg {
            max-width: 90vw;
          }
          .form-check-label a {
            font-size: 0.85em;
            padding: 1px 1.5px;
          }
      }



  </style>
</head>
<body class="relative min-h-screen w-full bg-gradient-to-b from-white to-blue-100 flex flex-col items-center justify-start">
  <!-- Alt Şehir Silüeti SVG -->
  <svg class="city-silhouette" viewBox="0 0 400 96" fill="none" preserveAspectRatio="none" width="100%" height="100%">
  <g>
    <!-- Sol bloklar -->
    <rect x="0" y="60" width="14" height="36" rx="2" fill="#6366f1" opacity="0.13"/>
    <rect x="16" y="40" width="22" height="56" rx="4" fill="#60a5fa" opacity="0.18"/>
    <!-- Çatılı bina -->
    <rect x="41" y="72" width="12" height="24" rx="2" fill="#818cf8" opacity="0.16"/>
    <polygon points="41,72 47,62 53,72" fill="#818cf8" opacity="0.28"/>
    <rect x="56" y="60" width="16" height="36" rx="3" fill="#38bdf8" opacity="0.14"/>
    <!-- Pencereli uzun blok -->
    <rect x="75" y="36" width="12" height="60" rx="2" fill="#60a5fa" opacity="0.15"/>
    <rect x="81" y="44" width="2" height="8" rx="1" fill="#fff" opacity="0.22"/>
    <rect x="81" y="60" width="2" height="8" rx="1" fill="#fff" opacity="0.15"/>
    <!-- Mini blok -->
    <rect x="90" y="80" width="7" height="16" rx="1.5" fill="#818cf8" opacity="0.19"/>
    
    <!-- Orta bloklar -->
    <rect x="100" y="66" width="18" height="30" rx="2" fill="#6366f1" opacity="0.09"/>
    <rect x="121" y="46" width="28" height="50" rx="3" fill="#818cf8" opacity="0.09"/>
    <rect x="152" y="78" width="12" height="18" rx="2" fill="#60a5fa" opacity="0.16"/>
    <!-- Yan yana iki blok farklı yükseklikte -->
    <rect x="170" y="69" width="16" height="27" rx="2" fill="#818cf8" opacity="0.12"/>
    <rect x="188" y="79" width="10" height="17" rx="2" fill="#6366f1" opacity="0.12"/>
    <!-- Asimetrik büyük blok -->
    <rect x="201" y="29" width="29" height="67" rx="4" fill="#60a5fa" opacity="0.14"/>
    <!-- Farklı ton kısa blok -->
    <rect x="233" y="74" width="12" height="22" rx="2" fill="#38bdf8" opacity="0.13"/>
    <!-- İnce yüksek blok -->
    <rect x="248" y="25" width="9" height="71" rx="2" fill="#818cf8" opacity="0.17"/>
    <!-- Diğer bloklar (düz, alçak/kalın) -->
    <rect x="260" y="79" width="23" height="17" rx="3" fill="#6366f1" opacity="0.1"/>
    <rect x="287" y="67" width="16" height="29" rx="2" fill="#60a5fa" opacity="0.11"/>
    <!-- Minik bloklar ve farklı renk -->
    <rect x="306" y="82" width="6" height="14" rx="1" fill="#818cf8" opacity="0.17"/>
    <rect x="316" y="68" width="10" height="28" rx="2" fill="#38bdf8" opacity="0.14"/>
    <!-- Geniş kısa bina -->
    <rect x="330" y="80" width="26" height="16" rx="2" fill="#6366f1" opacity="0.09"/>
    <!-- Sağda küçük çatılı blok -->
    <rect x="360" y="70" width="13" height="26" rx="2" fill="#60a5fa" opacity="0.12"/>
    <polygon points="360,70 366.5,61 373,70" fill="#60a5fa" opacity="0.22"/>
    <!-- Sağda yüksek son blok -->
    <rect x="378" y="24" width="18" height="72" rx="2.5" fill="#6366f1" opacity="0.11"/>
    <!-- En sağ mini pencere detayı -->
    <rect x="384" y="32" width="2.5" height="8" rx="1" fill="#fff" opacity="0.20"/>
  </g>
</svg>
    <!-- Responsive Header -->  
  <nav class="header d-flex justify-content-between align-items-center px-3">
    <span class="d-flex align-items-center gap-2">
        <img src="img/icon.png" alt="Logo" width="32" height="32">
        Yapıo
    </span>
    <button class="btn custom-btn" id="loginButton">PROJELER</button>  
  </nav>


  
  <div class="payment-container pb-5 mb-5">
        <div class="text-center mb-3">
            <h2 class="fw-bold">Premium Üyelik</h2>
            <div class="small text-success text-center mb-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#198754" class="bi bi-shield-check mb-1" viewBox="0 0 16 16">
                    <path d="M5.072 1.176a1 1 0 0 1 .82 0l2.904 1.249c.374.161.765.253 1.166.259.333.005.668-.047.999-.166l1.067-.388a1 1 0 0 1 1.137.508A8.998 8.998 0 0 1 13.857 8.46c0 2.434-.682 4.35-2.222 6.303A16.683 16.683 0 0 1 8 16a16.683 16.683 0 0 1-3.634-1.237C2.825 12.81 2.143 10.894 2.143 8.46c0-1.37.292-2.673.827-3.938a1 1 0 0 1 1.137-.508l1.067.388a4.545 4.545 0 0 0 .999.166c.401-.006.792-.098 1.166-.259z"/>
                    <path d="m10.854 6.854-3.5 3.5-.708-.708L8.793 6.5l-2.646-2.647.707-.707 3.5 3.5z"/>
                </svg>
                Ödemeniz <b>256-bit SSL</b>, <b>PCI DSS</b> ve <b>3D Secure</b> ile koruma altındadır.
                <span class="d-block text-secondary small mt-1">Kart bilgileriniz kesinlikle kaydedilmez ve güvenli ödeme altyapısı kullanılır.</span>
            </div>
        </div>
        <form id="paymentForm" autocomplete="off">
            <div class="mb-3">
                <label class="form-label">Üyelik Süresi</label>
                <div class="btn-group w-100 mb-2" role="group" aria-label="Üyelik Süresi">
                    <input type="radio" class="btn-check" name="subType" id="yearly" autocomplete="off" checked>
                    <label class="btn btn-outline-primary" for="yearly">Yıllık</label>
                </div>

                <!-- Proje seçim kutuları -->
                <div class="mt-3">
                    <label class="form-label">Proje Limiti</label>
                    <div class="btn-group w-100" role="group" aria-label="Proje Limiti">
                        <input type="radio" class="btn-check" name="projectLimit" id="limit2" autocomplete="off">
                        <label class="btn btn-outline-secondary" for="limit2" style="min-width:0;width:50%;">2 Proje</label>
                        <input type="radio" class="btn-check" name="projectLimit" id="limit4" autocomplete="off" checked>
                        <label class="btn btn-outline-secondary" for="limit4" style="min-width:0;width:50%;">4 Proje</label>
                    </div>
                </div>

                <!-- Fiyat kutusu -->
                <div class="mt-3">
                    <label class="form-label" for="feeInput">Fiyat</label>
                    <input type="text" id="feeInput" class="form-control" value="3800 ₺" readonly>
                </div>
            </div>
            <!--
            <div class="mb-3">
                <label class="form-label d-block mb-2">Ödeme Yöntemi</label>
                <div>
                    <input type="radio" class="btn-check" name="paymentType" id="bankaRadio" value="banka" autocomplete="off">
                    <label class="btn btn-outline-primary me-2" for="bankaRadio">Banka Havalesi/EFT</label>
                    <input type="radio" class="btn-check" name="paymentType" id="krediRadio" value="kredi" autocomplete="off">
                    <label class="btn btn-outline-primary" for="krediRadio">Kredi Kartı</label>
                </div>
            </div>-->
      
      <!-- YASAL ONAYLAR -->
      <div class="legal-check-fields mb-3" id="legalFields">
        <div class="form-check mt-2">
          <input class="form-check-input" type="checkbox" id="kvkkCheck" required>
          <label class="form-check-label user-select-none" for="kvkkCheck">
            <a tabindex="0" href="#" data-bs-toggle="modal" data-bs-target="#kvkkModal">Kişisel Verilerin Korunması Aydınlatma Metni</a>’ni okudum, onaylıyorum.
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="mesafeCheck" required>
          <label class="form-check-label user-select-none" for="mesafeCheck">
            <a tabindex="0" href="#" data-bs-toggle="modal" data-bs-target="#mesafeModal">Mesafeli Satış Sözleşmesi ve Üyelik Taahhütnamesi</a>’ni kabul ediyorum.
          </label>
        </div>
      </div>

      <!-- SUBMIT -->
      <div class="d-grid mt-4">
        <button type="submit" class="btn btn-success btn-lg" id="payBtn" disabled>Ödeme Yap</button>
      </div>
      <div class="small text-muted text-center mt-3">Güvenli ödeme ile hemen üyeliğinizi başlatabilirsiniz.</div>
    </form>
  </div>

  <!-- KVKK MODAL -->
  <div class="modal fade" id="kvkkModal" tabindex="-1" aria-labelledby="kvkkModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="kvkkModalLabel">Kişisel Verilerin Korunması Aydınlatma Metni</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Kapat"></button>
            </div>
        <div class="modal-body" style="font-size:0.98rem;">
            <b>KVKK ve Kullanım Şartları:</b>
            <ul>
            <li>Ad, soyad ve iletişim bilgileriniz kaydedilir.</li>
            <li>Bu veriler üyelik, ödeme ve yasal güvenlik amacıyla kullanılır.</li>
            <li>Daha fazla detay için resmi aydınlatma metnine göz atabilirsiniz.</li>
            </ul>
            <hr>
            <p><strong>1. Genel Bilgilendirme</strong><br>  
            Bu web ve mobil uygulamayı (“Yapıo”) kullanmaya başladığınızda aşağıdaki kullanım koşullarını kabul etmiş sayılırsınız. 
            Lütfen uygulamamızı kullanmadan önce metni dikkatlice okuyunuz.  
            </p>
            <p><strong>2. Hizmet Tanımı</strong><br>  
            Yapıo, kullanıcılarına inşaat maliyet hesaplama, malzeme ve işçilik listeleri oluşturma, proje yönetimi gibi 
            çeşitli inşaat işlemleri ile ilgili araçlar ve hizmetler sunar. Tüm hesaplamalar, kullanıcının girdiği bilgilere 
            dayanır ve kullanıcıya kolaylık amacıyla sağlanmaktadır.  
            </p>
            <p><strong>3. Üyelik ve Kullanıcı Yükümlülükleri</strong><br>  
            Uygulamaya üye olurken verdiğiniz bilgilerin doğru ve güncel olması sizin sorumluluğunuzdadır.
            Hesabınızın güvenliği ve gizliliği size aittir. Şifrenizi ve diğer bilgilerinizi korumak sizin yükümlülüğünüzdedir.
            Uygulama üzerinden yapılan tüm işlemlerden ve ortaya çıkan sonuçlardan kullanıcı sorumludur. 
            </p>
            <p><strong>4. Fikri Mülkiyet Hakları</strong><br>
            İnşaatHesap uygulamasındaki tüm içerik, tasarım ve hesaplama algoritmaları telif hakları ile korunmaktadır. 
            İzinsiz olarak kopyalanamaz, çoğaltılamaz, dağıtılamaz veya ticari amaçla kullanılamaz.
            </p>
            <p><strong>5. Gizlilik ve Veri Koruma</strong><br> 
            Kullanıcı bilgileriniz [Gizlilik Politikası/KVKK Metni] kapsamında korunmakta olup, üçüncü kişilerle paylaşılmaz.
            Hesap ve proje verilerinizin güvenliği bizim için önceliklidir.
            </p>
            <p><strong>6. Hizmette Değişiklik ve Sorumluluğun Sınırlandırılması</strong><br> 
            Yapıo, önceden bildirimde bulunmaksızın hizmet içeriğinde ve koşullarda değişiklik yapma hakkını saklı 
            tutar. Uygulamanın sunduğu sonuçlar sadece kullanıcıya yardımcı olmayı amaçlar; resmi veya bağlayıcı bir teknik 
            veya hukuki belge olarak kullanılamaz. Olası teknik sorunlar, veri kaybı veya hizmet kesintilerinden İnşaatHesap
            sorumlu tutulamaz.
            </p>
            <p><strong>7. Uygulanacak Hukuk ve Yetkili Mahkeme</strong><br> 
            Bu koşullar Türkiye Cumhuriyeti kanunlarına tabidir. Doğabilecek uyuşmazlıklarda İstanbul Mahkemeleri ve 
            İcra Daireleri yetkilidir.
            </p>
            <p><strong>8. İletişim</strong><br> 
            Her türlü soru ve sorunlarınız için: <a href="mailto:tahsintanil@gmail.com">tahsintanil@gmail.com</a>
            </p>
                </div>
            </div>
        </div>
    </div>

  <!-- MESAFE SÖZLEŞMESİ MODAL -->
  <div class="modal fade" id="mesafeModal" tabindex="-1" aria-labelledby="mesafeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="mesafeModalLabel">Mesafeli Satış Sözleşmesi ve Üyelik Taahhütnamesi</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Kapat"></button>
        </div>
        <div class="modal-body" style="font-size:0.97rem;">
            <strong>Mesafeli Satış Sözleşmesi ve Üyelik Taahhütnamesi</strong>
            <p>
            İşbu sözleşme, www.insaathesap.com veya mobil uygulaması üzerinden dijital ürün ya da üyelik satın alan kullanıcı (Alıcı) ile hizmet sunan firma (Satıcı) arasında 6502 Sayılı Tüketicinin Korunması Hakkında Kanun ve ilgili yönetmelikler çerçevesinde elektronik ortamda akdedilmiştir.
            </p>
            <hr>
            <p><strong>1. Sözleşmenin Tarafları</strong><br>
            <b>Satıcı:</b> (Firmanın Adı, Adres, Telefon, E-posta)<br>
            <b>Alıcı (Üye):</b> Üyelik kaydında beyan edilen bilgiler.</p>
            <p><strong>2. Konu</strong><br>
            Bu sözleşmenin konusu, satıcının internet sitesinden/yazılım üzerinden sunduğu dijital ürün, hizmet veya üyelik satışı ile ilgili olarak tarafların hak ve yükümlülüklerinin belirlenmesidir.</p>
            <p><strong>3. Üyelik/Hizmetin Özellikleri</strong><br>
            Üyelik başlatıldığında kullanıcıya inşaat maliyet hesaplama, malzeme ve işçilik listeleri oluşturma, proje yönetimi gibi çeşitli araçlara erişim ve hizmet sağlanır.</p>
            <p><strong>4. Ödeme, Üyelik Süresi ve Başlangıcı</strong><br>
            Alıcı, seçtiği ödeme yöntemi üzerinden hizmet bedelini ödemeyi kabul eder. Üyelik/hizmet, ödeme onaylanır onaylanmaz başlar ve seçilen süre sonunda sona erer.</p>
            <p><strong>5. Cayma Hakkı</strong><br>
            Dijital içerik/hizmetlerde hizmetin ifasına başlanması ile birlikte cayma hakkı sona erer. Üyelik/hizmet başlatıldıktan sonra iade hakkı kullanılmaz.</p>
            <p><strong>6. İptal ve İade Şartları</strong><br>
            Hizmetin niteliği gereği; üyelik açılıp hizmet sunulmaya başladıktan sonra iade yapılmaz. Teknik sorunlar hariç, kullanılmayan süre için para iadesi talep edilemez.</p>
            <p><strong>7. Kişisel Verilerin Korunması</strong><br>
            Alıcının bilgileri sadece hizmet amacıyla kullanılır ve 3. kişilerle paylaşılmaz. Detaylı KVKK metni ayrıca sağlanmıştır.</p>
            <p><strong>8. Hak ve Yükümlülükler</strong><br>
            Alıcı, üyelik sırasında verdiği bilgilerin doğruluğunu ve hizmeti etik/yasal kullanımını taahhüt eder. Satıcı, hizmetin güvenli sunulmasından sorumludur; teknik arızalardan dolayı sorumluluğu sınırlıdır.</p>
            <p><strong>9. Sözleşmenin Yürürlüğü</strong><br>
            Üyelik işlemi ve ödeme tamamlandığında, işbu sözleşmenin tüm şartları kabul edilmiş olur. Sözleşme dijital ortamda yürürlüktedir ve saklanmaktadır.</p>
            <p><strong>10. Uyuşmazlıkların Çözümü</strong><br>
            Tüketicinin başvurabileceği hakem heyeti ve tüketici mahkemeleri Satıcı'nın bulunduğu yerde yetkilidir.</p>
            <p><strong>11. İletişim Bilgileri</strong><br>
            Satıcı: (Firma adı, adres)<br>
            E-posta: tahsintanil@gmail.com<br>
            Telefon: (...)</p>
            </div>
            </div>
        </div>
    </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script type="module">
    import { showWarningMessage } from '/js/showMessage.js';

    const loginButton = document.getElementById("loginButton");
    const buildingContainer = document.getElementById("building-container");
    const fullName = document.getElementById('userFullName');
    const email = document.getElementById('userEmail');
    //const bankaRadio = document.getElementById('bankaRadio');
    //const krediRadio = document.getElementById('krediRadio');
    const payBtn = document.getElementById('payBtn');
    const kvkkCheck = document.getElementById('kvkkCheck');
    const mesafeCheck = document.getElementById('mesafeCheck');
    const feeInput = document.getElementById('feeInput');
    const limit2 = document.getElementById('limit2');
    const limit4 = document.getElementById('limit4');

    const params = new URLSearchParams(window.location.search);
    const from = params.get('from') || "";
    console.log("from:",from);

    let userId = null;
    let projectNumber = null;
    let projectName = null;
    let userType = null;

    // DOM yüklendiğinde işlem başlat  
    document.addEventListener("DOMContentLoaded", () => {  

      if(from === ""){
        showWarningMessage("Daha fazla proje oluşturmak için üyeliğinizi yenileyin", "tamam", false);
      } else{
        showWarningMessage("Resim yüklemek için üyeliğinizi yenileyin", "tamam", false);
      }


      window.user = {{#if user}}
          { "userId": "{{user.id}}", "projectNumber": "{{projectNumber}}", "userType": "{{userType}}", "project": {{{json project}}} }
      {{else}}
          { "role": "{{role}}" }
      {{/if}};
      console.log(window.user);

      userId = window.user.userId;
      projectNumber = window.user.projectNumber;
      projectName = params.get('projectName') || (window.user.project && window.user.project.projectName);
      userType = window.user.userType;
      
      if(userId){
          loginButton.style.display = "block";
      } else{
          loginButton.style.display = "none";
      }

      //console.log(userId);
      //console.log(projectNumber);
      //console.log(projectName);
      //console.log(userType);

  });

  loginButton.addEventListener("click", () => {
      //window.location.href = `/?userId=${encodeURIComponent(userId)}`;
      window.location.href = "/";
  });


    // ilk açılışta doğru fiyatı göster
    function setInitialFee() {
      feeInput.value = limit4.checked ? "3800 ₺" : "2400 ₺";
    }
    setInitialFee();
    // Proje limitleri değiştikçe fiyatı güncelle
    limit2.addEventListener('change', function() {
      if (this.checked) feeInput.value = "2400 ₺";
    });
    limit4.addEventListener('change', function() {
      if (this.checked) feeInput.value = "3800 ₺";
    });

    document.getElementById('paymentForm').addEventListener('input', function() {
        const kvkkOk = kvkkCheck.checked;
        const mesafeOk = mesafeCheck.checked;
        payBtn.disabled = !(kvkkOk && mesafeOk);
    });

    document.getElementById('paymentForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const projectLimit = limit4.checked ? 4 : 2;
        // Backend’e fetch ile gönder, gelen ödeme linkine yönlendir:
        const data = {
            userId,
            projectNumber,
            userType,
            projectLimit
        };
        try {
          const response = await fetch('/payment', {
              method: 'POST',
              headers: {'Content-Type': 'application/json'},
              body: JSON.stringify(data)
          });
          const resJson = await response.json();

          if (resJson && resJson.paymentFormHtml) {
              const win = window.open("", "_blank");
              win.document.write(resJson.paymentFormHtml);
              win.document.close();
          } else if(resJson && resJson.message) {
              // Hata mesajı göster
              showWarningMessage(resJson.message, "tamam", false);
          }
      } catch (err){
          showWarningMessage("Sunucuya bağlanılamadı: " + err, "tamam", false);
      }
    });
    
  </script>
</body>
</html>